<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>관리자 페이지</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
<div class="container">
    <!-- 사이드바 -->
    <div class="sidebar">
        <div class="sidebar-item" id="dashboard-link">대시보드</div>
        <div class="sidebar-item" id="user-info-link">회원 정보</div>
        <div class="sidebar-item" id="partner-list-link">파트너 신청 목록</div>
        <div class="sidebar-item" id="notification-link">알림</div>
        <div class="sidebar-item" id="report-link">신고 목록</div>
        <div class="sidebar-item" id="event-link">이벤트</div>
        <div class="sidebar-item" id="notice-link">공지사항</div>
    </div>

    <!-- 메인 콘텐츠 영역 -->
    <div class="content">
        <!-- 대시보드 -->
        <div id="dashboard" class="page visible">
            <h1>대시보드</h1>
            <div>총 회원 수: <span id="user-count">0</span></div>
            <div>총 신청 수: <span id="application-count">0</span></div>
            <div>승인된 파트너 수: <span id="approved-count">0</span></div>
        </div>



  <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->


        <!-- 회원 정보 -->
        <div id="user-info" class="page ">
            <h1>회원 정보</h1>
            <div class="search-bar">
                <input type="text" id="search" placeholder="이름, 아이디, 이메일 검색...">
                <button id="search-btn">검색</button>
            </div>
            <table id="user-table">
                <thead>
                <tr>
                    <th>번호</th>
                    <th>아이디</th>
                    <th>이름</th>
                    <th>이메일</th>
                    <th>상세보기</th>
                </tr>
                </thead>
                <tbody>
                <!-- 회원 목록 데이터가 여기 들어옵니다 -->
                </tbody>
            </table>
            <div class="pagination">
                <!-- 페이징 버튼들 -->
                <button class="page-btn">1</button>
                <button class="page-btn">2</button>
                <!-- ... -->
            </div>
        </div>


        <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->


        <div id="partner-list" class="page ">
            <h1>파트너 신청 목록</h1>

            <div class="search-container">
                <label>검색 기준:</label>
                <select id="searchType">
                    <option value="pname">상호명</option>
                    <option value="uname">신청자 이름</option>
                </select>

                <input type="text" id="searchKeyword" placeholder="검색어 입력">

                <label>상태:</label>
                <select id="statusFilter">
                    <option value="">전체</option>
                    <option value="심사중">심사중</option>
                    <option value="반려">반려</option>
                    <option value="승인됨">승인됨</option>
                </select>

                <button onclick="loadData(0)">검색</button>
            </div>

            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>상호명</th>
                    <th>신청자</th>
                    <th>상태</th>
                </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>

            <div id="pagination" class="pagination"></div>

        </div>


        <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->


        <!-- 알림 -->
        <div id="notifications" class="page">
            <h1>알림</h1>

            <div id="search-container">

            </div>
            <div id="notification-form-container"></div>
            <table>
                <thead>
                <tr>
                    <th>유저번호</th>
                    <th>제목</th>
                    <th>내용</th>
                    <th>보낸 사람</th>
                    <th>유형</th>
                    <th>날짜</th>
                    <th>읽음 여부</th>
                </tr>
                </thead>
                <tbody id="notifications-list">

                </tbody>
                <tbody id="notification-table-body">
                <!-- 알림 데이터 삽입 영역 -->
                </tbody>
            </table>

            <div id="notification-pagination" class="mt-4 flex justify-center"></div>
        </div>


        <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->


        <!-- 신고 목록 -->
        <div id="report-list" class="page">
            <h1>신고 목록</h1>
            <button onclick="openReportPopup()">신고하기</button>
            <div class="search-container">
                <label>검색 기준:</label>
                <select id="report-search-type">
                    <option value="uname">신고자 이름</option>
                    <option value="reportedName">신고 당한 유저 이름</option>
                </select>

                <input type="text" id="report-search-keyword" placeholder="검색어 입력">

                <button onclick="loadReportData(0)">검색</button>
            </div>

            <table>
                <thead>
                <tr>
                    <th>신고 ID</th>
                    <th>신고자 이름</th>
                    <th>신고 당한 유저</th>
                    <th>신고 내용</th>
                    <th>활성화</th>
                    <th>비활성화</th>
                </tr>
                </thead>
                <tbody id="report-table-body">
                <!-- 신고 목록 데이터가 여기에 삽입됩니다 -->
                </tbody>
            </table>

            <div id="report-pagination" class="pagination"></div>
        </div>


        <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->


        <div id="event-list" class="page">
            <h1>이벤트 목록</h1>

            <div class="search-container">
                <label>검색 기준:</label>
                <select id="event-search-type">
                    <option value="title">제목</option>
                    <option value="status">상태</option>
                </select>

                <input type="text" id="event-search-keyword" placeholder="검색어 입력">
                <button onclick="loadEventData(0)">검색</button>
            </div>

            <table>
                <thead>
                <tr>
                    <th>TOP</th>
                    <th>번호</th>
                    <th>썸네일</th>
                    <th>제목</th>
                    <th>기간</th>
                    <th>상태</th>
                </tr>
                </thead>
                <tbody id="event-table-body">
                <!-- 이벤트 데이터 삽입 영역 -->
                </tbody>
            </table>

            <div id="event-pagination" class="pagination"></div>

            <div class="text-end mt-4">
                <button onclick="location.href='/event/create'" class="btn btn-primary">이벤트 작성</button>
            </div>
        </div>


        <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->


        <div id="notice-list" class="page">
            <h1>공지사항 목록</h1>

            <!-- 검색 기능 -->
            <div class="search-bar">
                <input type="text" id="notice-search-keyword" placeholder="제목 검색...">
                <button id="notice-search-btn">검색</button>
            </div>

            <!-- 공지사항 테이블 -->
            <table id="notice-table">
                <thead>
                <tr>
                    <th>TOP</th>
                    <th>번호</th>
                    <th>제목</th>
                    <th>작성일</th>
                    <th>조회수</th>
                    <th>상세보기</th>
                </tr>
                </thead>
                <tbody id="notices-table">
                <!-- 공지사항 목록 데이터가 여기 들어옵니다 -->
                </tbody>
            </table>

            <!-- 페이지네이션 -->
            <div id="notice-pagination">
                <button class="page-btn">1</button>
                <button class="page-btn">2</button>
                <!-- 추가 페이지 버튼 -->
            </div>

            <!-- 공지사항 작성 버튼 -->
            <div class="text-end mt-4">
                <button onclick="location.href='/notices/create'" class="btn btn-primary">공지사항 작성</button>
            </div>
        </div>

        <!-- 상세보기 페이지 (팝업 형태로 구현 가능) -->
        <div id="notice-detail" class="popup hidden">
            <h2>공지사항 상세보기</h2>
            <div id="notice-detail-content">
                <!-- 상세 내용이 여기에 삽입됩니다 -->
            </div>
        </div>



        <div id="user-detail" class="popup hidden">
            <div id="user-details"></div>

        </div>


    </div>
</div>

<script src="/js/admin/report.js"></script>
<script src="/js/admin/searchNotifications.js"></script>
<script src="/js/admin/notification.js"></script>
<script src="/js/admin/partneradmin.js"></script>
<script src="/js/admin/app.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/reports-create.js"></script>
<script src="/js/admin/event-list.js"></script>
<script src="/js/admin/notification-list.js"></script>



<script>
    const pages = document.querySelectorAll('.page');
    const links = {
        'dashboard-link': 'dashboard',
        'user-info-link': 'user-info',
        'partner-list-link': 'partner-list',
        'notification-link': 'notifications',
        'report-link' : 'report-list',
        'event-link' : 'event-list',
        'notice-link': 'notice-list'
    };

    Object.keys(links).forEach(linkId => {
        document.getElementById(linkId).addEventListener('click', () => {
            pages.forEach(p => p.classList.remove('visible'));
            document.getElementById(links[linkId]).classList.add('visible');
        });
    });
    document.addEventListener("DOMContentLoaded", function () {
        fetch("/api/admin/counts", {
            headers: {
                "Authorization": "Bearer " + localStorage.getItem("authToken")
            }
        })
            .then(res => res.json())
            .then(data => {
                document.getElementById("user-count").innerText = data.totalUsers;
                document.getElementById("application-count").innerText = data.totalApplications;
                document.getElementById("approved-count").innerText = data.approvedPartners;
            });
    });


</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>λ§μ΄νμ΄μ§€</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .grade-silver {
            color: #a0aec0;
        }

        .grade-gold {
            color: #fbbf24;
        }

        .grade-platinum {
            color: #cbd5e0;
        }

        .grade-diamond {
            color: #60a5fa;
        }
    </style>
</head>
<body class="bg-sky-50 min-h-screen">

<div class="max-w-6xl mx-auto grid grid-cols-[auto,1fr] gap-0 min-h-screen">
    <!-- μ‚¬μ΄λ“λ°” -->
    <aside class="bg-white p-6 rounded-l-xl shadow flex flex-col gap-4 text-sm w-52">
        <button onclick="showSection('profile')" class="text-left text-sky-600 font-medium">π‘¤ νμ› μ •λ³΄</button>
        <button onclick="showSection('reservation')" class="text-left">π“… μμ•½ λ‚΄μ—­</button>
        <button onclick="showSection('points')" class="text-left">π’° ν¬μΈνΈ</button>
        <button onclick="showSection('password')" class="text-left">π”’ λΉ„λ°€λ²νΈ λ³€κ²½</button>
        <button onclick="showSection('alarm')" class="text-left">π”” μ•λ¦Ό μ„¤μ •</button>
        <button onclick="showSection('withdraw')" class="text-left text-red-500">β νμ› νƒν‡΄</button>
    </aside>

    <!-- λ³Έλ¬Έ μ„Ήμ…λ“¤ -->
    <div class="bg-white rounded-r-xl shadow p-6 space-y-8">

        <!-- νμ› μ •λ³΄ -->
        <section id="profile">
            <h1 class="text-3xl font-bold mb-6 text-sky-600">λ§μ΄νμ΄μ§€</h1>

            <form id="profileForm" class="relative space-y-4">
                <!-- λ“±κΈ‰ -->
                <div class="absolute top-4 right-4 text-xl font-extrabold">
                    <div th:switch="${user.level}" class="flex items-center gap-2 bg-white/70 px-4 py-1 rounded-full shadow-sm">
                        <span th:case="0" class="grade-silver">π©¶ μ‹¤λ²„</span>
                        <span th:case="1" class="grade-gold">π¥‡ κ³¨λ“</span>
                        <span th:case="2" class="grade-platinum flex items-center gap-1">
              <svg class="w-6 h-6 text-emerald-500" xmlns="http://www.w3.org/2000/svg" fill="none"
                   viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                      d="M12 2l3 4.5h6l-4 5 4 5h-6l-3 4.5-3-4.5H3l4-5-4-5h6l3-4.5z"/>
              </svg>
              ν”λν‹°λ„
            </span>
                        <span th:case="3" class="grade-diamond text-sky-500">π’ λ‹¤μ΄μ•„</span>
                    </div>
                </div>

                <!-- ν”„λ΅ν•„ μ΄λ―Έμ§€ -->
                <div class="flex items-center gap-4">
                    <img id="profilePreview"
                         th:src="${user.profile_image != null} ? @{${user.profile_image}(v=${#dates.createNow().time})} : @{/img/default.png}"
                         class="w-24 h-24 rounded-full object-cover border" alt="ν”„λ΅ν•„ μ΄λ―Έμ§€" />
                    <input type="file" id="fileInput" name="profileImage" accept="image/*"
                           onchange="previewImage(event)"
                           class="hidden file:border file:mr-4 file:px-3 file:py-1 file:bg-sky-500 file:text-white"/>
                </div>

                <!-- μ •λ³΄ μ…λ ¥ -->
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium">μ΄λ¦„</label>
                        <input type="text" name="uname" th:value="${user.uname}"
                               class="w-full mt-1 p-2 border rounded editable" readonly />
                    </div>
                    <div>
                        <label class="block text-sm font-medium">λ‹‰λ„¤μ„</label>
                        <input type="text" name="nickname" th:value="${user.nickname}"
                               class="w-full mt-1 p-2 border rounded editable" readonly />
                    </div>
                    <div>
                        <label class="block text-sm font-medium">μ΄λ©”μΌ</label>
                        <input type="email" name="email" th:value="${user.email}"
                               class="w-full mt-1 p-2 border rounded bg-gray-100" readonly />
                    </div>
                    <div>
                        <label class="block text-sm font-medium">μ „ν™”λ²νΈ</label>
                        <div class="flex gap-2">
                            <input type="text" name="phone1" th:value="${user.phone1}" readonly class="w-1/4 p-2 border bg-gray-100 rounded" />
                            <input type="text" name="phone2" th:value="${user.phone2}" maxlength="4"
                                   class="w-1/4 p-2 border rounded editable" readonly />
                            <input type="text" name="phone3" th:value="${user.phone3}" maxlength="4"
                                   class="w-1/4 p-2 border rounded editable" readonly />
                        </div>
                    </div>
                </div>

                <!-- λ²„νΌ -->
                <div class="mt-4 space-x-2">
                    <button type="button" id="editBtn" onclick="enableEdit()" class="bg-sky-500 text-white px-4 py-2 rounded hover:bg-sky-600">
                        μ •λ³΄ μμ •
                    </button>
                    <button type="submit" id="submitBtn" class="hidden bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                        μ™„λ£
                    </button>
                    <button type="button" id="cancelBtn" onclick="cancelEdit()" class="hidden bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500">
                        μ·¨μ†
                    </button>
                </div>
            </form>
        </section>

        <!-- ν¬μΈνΈ -->
        <section id="points" class="hidden">
            <h2 class="text-xl font-bold text-sky-600 mb-4">π’° λ³΄μ  ν¬μΈνΈ</h2>
            <p class="text-4xl font-extrabold text-sky-500" th:text="${user.points} + ' P'">0 P</p>
        </section>

        <!-- λΉ„λ°€λ²νΈ λ³€κ²½ -->
        <section id="password" class="space-y-4">
            <h2 class="text-xl font-bold text-sky-600 mb-4">π”’ λΉ„λ°€λ²νΈ λ³€κ²½</h2>

            <form th:action="@{/mypage/password}" method="post" th:object="${passwordForm}">
                <input type="password" th:field="*{currentPassword}" placeholder="ν„μ¬ λΉ„λ°€λ²νΈ" class="w-full p-2 border rounded" />
                <input type="password" th:field="*{newPassword}" placeholder="μƒ λΉ„λ°€λ²νΈ" class="w-full p-2 border rounded" />
                <input type="password" th:field="*{confirmPassword}" placeholder="μƒ λΉ„λ°€λ²νΈ ν™•μΈ" class="w-full p-2 border rounded" />
                <button type="submit" class="bg-sky-500 text-white px-4 py-2 rounded hover:bg-sky-600">ν™•μΈ</button>

                <!-- λ©”μ‹μ§€ ν‘μ‹ -->
                <p class="text-red-500" th:if="${errorMessage}" th:text="${errorMessage}"></p>
                <p class="text-green-500" th:if="${successMessage}" th:text="${successMessage}"></p>
            </form>
        </section>
        <!-- νμ› νƒν‡΄ -->
        <section id="withdraw" class="hidden space-y-4">
            <h2 class="text-xl font-bold text-red-500 mb-4">β νμ› νƒν‡΄</h2>
            <p class="text-gray-700">μ •λ§ νƒν‡΄ν•μ‹κ² μµλ‹κΉ? νƒν‡΄ μ‹ λ¨λ“  μ •λ³΄κ°€ μ‚­μ λ©λ‹λ‹¤.</p>
            <input type="password" placeholder="λΉ„λ°€λ²νΈ μ…λ ¥" class="w-full p-2 border rounded" />
            <button class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">νƒν‡΄ν•κΈ°</button>
        </section>

        <!-- μμ•½ λ‚΄μ—­ -->
        <section id="reservation" class="hidden">
            <h2 class="text-xl font-bold text-sky-600 mb-4">π“… μμ•½ λ‚΄μ—­</h2>
            <p class="text-gray-500">μ¤€λΉ„ μ¤‘μ…λ‹λ‹¤.</p>
        </section>

        <!-- μ•λ¦Ό μ„¤μ • -->
        <section id="alarm" class="hidden">
            <h2 class="text-xl font-bold text-sky-600 mb-4">π”” μ•λ¦Ό μ„¤μ •</h2>
            <p class="text-gray-500">μ¤€λΉ„ μ¤‘μ…λ‹λ‹¤.</p>
        </section>
    </div>
</div>

<!-- Script -->
<script>
    function showSection(id) {
        const sections = document.querySelectorAll('section');
        sections.forEach(s => s.style.display = 'none');
        document.getElementById(id).style.display = 'block';
    }

    function previewImage(event) {
        const reader = new FileReader();
        reader.onload = () => {
            document.getElementById('profilePreview').src = reader.result;
        };
        reader.readAsDataURL(event.target.files[0]);
    }

    function enableEdit() {
        document.querySelectorAll('.editable').forEach(i => i.removeAttribute('readonly'));
        document.getElementById('fileInput').classList.remove('hidden');
        document.getElementById('editBtn').classList.add('hidden');
        document.getElementById('submitBtn').classList.remove('hidden');
        document.getElementById('cancelBtn').classList.remove('hidden');
    }

    function cancelEdit() {
        document.getElementById('profileForm').reset();
        document.querySelectorAll('.editable').forEach(i => i.setAttribute('readonly', true));
        document.getElementById('fileInput').classList.add('hidden');
        document.getElementById('editBtn').classList.remove('hidden');
        document.getElementById('submitBtn').classList.add('hidden');
        document.getElementById('cancelBtn').classList.add('hidden');
    }

    // μ΄κΈ°ν™”λ©΄
    window.onload = () => showSection('profile');
</script>

</body>
</html>


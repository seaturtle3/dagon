<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head th:insert="~{fragments/common_head :: head}">
    <meta charset="UTF-8">
    <title>물때 정보</title>

</head>
<style>

    h2 {
        font-size: 20px;
        margin-top: 30px;
    }

    h3 {
        margin: 0;
        font-size: 16px;
    }

    .region-wrapper {
        display: flex;
        flex-wrap: wrap;
        gap: 30px;
        margin-bottom: 20px;
        align-items: flex-start;
    }

    .region-block {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }

    .station-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        margin-top: 6px;
    }

    button {
        padding: 6px 12px;
        font-size: 14px;
        border: 1px solid #ccc;
        background-color: #f9f9f9;
        cursor: pointer;
        border-radius: 4px;
        transition: background-color 0.2s;
    }

    button:hover {
        background-color: #dceeff;
    }

    .selected {
        background-color: #e0f0ff;
        font-weight: bold;
    }

    ul {
        padding-left: 20px;
    }

    li {
        margin-bottom: 8px;
        font-size: 15px;
    }
</style>
<body>
<div th:replace="~{fragments/header :: header}"></div>

<h2>지역 선택</h2>
<form id="stationForm" method="get" action="/tide/multtae">
    <input type="hidden" name="region" id="regionInput" th:value="${region}">
    <input type="hidden" name="stationCode" id="stationCodeInput" th:value="${stationCode}">
    <input type="hidden" name="date" id="dateInput" th:value="${date}">
</form>

<div class="region-wrapper">
    <div th:each="entry : ${groupedStations}" class="region-block">
        <h3 th:text="${entry.key.korean}"></h3>
        <div class="station-buttons">
            <button th:each="station : ${entry.value}"
                    type="button"
                    th:text="${station.stationName}"
                    th:attr="data-code=${station.stationCode},data-region=${station.region}"
                    th:classappend="${station.stationCode == stationCode} ? 'selected'"
                    onclick="selectStation(this.getAttribute('data-region'), this.getAttribute('data-code'))">
            </button>
        </div>
    </div>
</div>
<hr/>

<h2>물때 정보</h2>
<div th:if="${tideItems != null}">
    <ul>
        <li th:each="item : ${tideItems}">
            시각: <span th:text="${item.tph_time}"></span>,
            수위: <span th:text="${item.tph_level}"></span>,
            구분: <span th:text="${item.hl_code}"></span>
        </li>
    </ul>
</div>

<script>
    function selectStation(region, stationCode) {
        document.getElementById("regionInput").value = region;
        document.getElementById("stationCodeInput").value = stationCode;
        document.getElementById("stationForm").submit();
    }
</script>
</body>
</html>
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>이벤트 목록</title>
    <style>
        .active {
            font-weight: bold;
            text-decoration: underline;
        }
    </style>
</head>
<body>

<h1>이벤트 목록</h1>

<form method="get" action="/event">
    <label for="size">한 페이지 글 수:</label>
    <select name="size" id="size" onchange="this.form.submit()">
        <option th:value="5" th:selected="${size == 5}">5</option>
        <option th:value="10" th:selected="${size == 10}">10</option>
        <option th:value="20" th:selected="${size == 20}">20</option>
    </select>
    <input type="hidden" name="page" th:value="${currentPage}">
</form>

<table border="1">
    <thead>
    <tr>
        <th>TOP</th>
        <th>번호</th>
        <th>썸네일</th>
        <th>제목</th>
        <th>기간</th>
        <th>상태</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="e, iterStat : ${events}">
        <td th:text="${e.isTop ? '✔' : ''}">✔</td>
        <td th:text="${iterStat.count}">1</td>

        <td th:if="${e.thumbnailUrl != null}">
            <img th:src="${e.thumbnailUrl}" alt="썸네일" width="100">
        </td>

        <td th:if="${e.thumbnailUrl == null}"></td>

        <td>
            <a th:href="@{'/event/' + ${e.eventId}}" th:text="${e.title}">이벤트 제목</a>
        </td>
        <td th:text="${(e.startAt == null and e.endAt == null) ? '상시 이벤트' : e.startAt + ' ~ ' + e.endAt}">기간</td>
        <td th:text="${e.eventStatus.korean}">진행중</td>
    </tr>
    </tbody>
</table>

<a href="/event/new">이벤트 작성</a>

<!-- 페이지네이션 -->
<div th:if="${totalPages > 1}">
    <a th:if="${currentPage > 0}"
       th:href="@{'/event?page=' + ${currentPage - 1} + '&size=' + ${size}}">이전</a>

    <span th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
        <a th:href="@{'/event?page=' + ${i} + '&size=' + ${size}}"
           th:text="${i + 1}"
           th:classappend="${i == currentPage} ? 'active' : ''"
           style="margin: 0 5px;"></a>
    </span>

    <a th:if="${currentPage + 1 < totalPages}"
       th:href="@{'/event?page=' + ${currentPage + 1} + '&size=' + ${size}}">다음</a>
</div>

</body>
</html>
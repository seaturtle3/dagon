<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>FAQ</title>
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <script>
        function deleteFaq(id) {
            if (!confirm("정말 삭제하시겠습니까?")) return;
            fetch(`/api/admin/faq/${id}`, {method: 'DELETE'})
                .then(res => {
                    if (res.ok) {
                        alert("삭제되었습니다.");
                        location.reload();
                    } else {
                        alert("삭제 실패");
                    }
                });
        }
    </script>
</head>
<body>


<h1>자주 묻는 질문</h1>

<!-- 관리자만 보이는 등록 버튼 -->
<div th:if="${isAdmin}">
    <button th:onclick="'location.href=\'/faq/create?page=' + ${pagination.currentPage} + '&size=' + ${size} + '\''">FAQ 등록</button>
</div>

<div th:replace="~{fragments/paging_options :: sizeSelector('/faq', ${size}, ${pagination.currentPage})}"></div>
<hr>
<!-- FAQ 목록 출력 -->
<div th:each="faq : ${faqPage.content}">
    <div>
        <strong th:text="${faq.question}"></strong><br>
        <span th:utext="${faq.answer}"></span><br>

        <!-- 관리자만 보이는 수정/삭제 버튼 -->
        <div th:if="${isAdmin}">
            <small th:text="'노출 상태: ' + (faq.isActive ? '활성' : '비활성')"></small><br>
            <small th:text="'표시 순서: ' + ${faq.displayOrder}"></small><br>

            <button th:onclick="'location.href=\'/faq/' + ${faq.faqId} + '/edit?page=' + ${pagination.currentPage} + '&size=' + ${size} + '\''">수정</button>
            <button th:onclick="'deleteFaq(' + ${faq.faqId} + ')'">삭제</button>
        </div>
    </div>
    <hr>
</div>

<!-- 페이징 영역 -->
<div th:replace="~{fragments/pagination :: pagination(${pagination}, ${size})}"></div>

</body>
</html>
<!DOCTYPE html>
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>파트너 신청 목록</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 8px; border: 1px solid #ddd; text-align: center; }
        .pagination { margin-top: 15px; text-align: center; }
        .pagination button { margin: 0 3px; }
        tr:hover { background-color: #f1f1f1; } /* 행 hover 효과 */
    </style>
</head>
<body>
<h1>파트너 신청 목록</h1>

<div>
    <label>검색 기준:</label>
    <select id="searchType">
        <option value="pname">상호명</option>
        <option value="uname">신청자 이름</option>
    </select>

    <input type="text" id="searchKeyword" placeholder="검색어 입력">

    <label>상태:</label>
    <select id="statusFilter">
        <option value="">전체</option>
        <option value="심사중">심사중</option>
        <option value="반려">반려</option>
        <option value="심사완료">심사완료</option>
    </select>

    <button onclick="loadData(0)">검색</button>
</div>

<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>상호명</th>
        <th>신청자</th>
        <th>상태</th>
    </tr>
    </thead>
    <tbody id="tableBody"></tbody>
</table>

<div id="pagination"></div>

<script>
    const size = 10;

    function loadData(page) {
        const keyword = $('#searchKeyword').val();
        const type = $('#searchType').val();
        const status = $('#statusFilter').val();

        $.ajax({
            url: `/api/partners`,
            type: 'GET',
            data: {
                page: page,
                size: size,
                keyword: keyword,
                type: type,
                status: status
            },
            success: function(data) {
                const body = $('#tableBody');
                body.empty();

                data.content.forEach(item => {
                    body.append(`
                        <tr onclick="goToDetail(${item.id})" style="cursor:pointer;">
                            <td>${item.id}</td>
                            <td>${item.pname}</td>
                            <td>${item.uname}</td>
                            <td>${item.paStatus}</td>
                        </tr>
                    `);
                });

                const pagination = $('#pagination');
                pagination.empty();
                for (let i = 0; i < data.totalPages; i++) {
                    pagination.append(`<button onclick="loadData(${i})">${i + 1}</button>`);
                }
            }
        });
    }

    function goToDetail(id) {
        window.location.href = `/partner/detail/${id}`;
    }

    $(document).ready(function () {
        loadData(0);
    });
</script>
</body>
</html>